# אותות אקראיים

נתחיל לחקור את היצור המתמטי הזה שנקרא אות אקראי.
דרך אחת לא מאוד שימושית לאפיין אותו היא לומר שיש לנו אנסמבל (אינסופי) עם כל 
האפשרויות השונות לאותות ולכל אחד מהם הסתברות (או צפיפות הסתברות). ממש קשה
לעבוד עם אובייקט כזה. והוא מאוד מאוד כללי.

במקום זה נתחיל מלהסתכל על זמן מסויים $t_{i}$ ולשאול מה הערכים האפשריים של הרעש שם.

### משתנה אקראי

אם היינו מבצעים הרבה מאוד ניסויין ומסתכלים רק על הtאות האקראי (הרעש) בזמן $t_{i}$ היינו מקבלים המון
ערכים שונים. נקרא להם $x\left(t_{i}\right)$. זה ממש כמו הטלות של קובייה רק שיש לנו טווח ערכים רציף.
נוכל לאפיין את הסטטיסטיקה של הערכים על ידי **פונקציית צפיפות הסתברות**. 

באופן כללי ל$x\left(t_{i}\right)$ נקרא משתנה אקראי.

```{admonition} מה זה פונקציית צפיפות הסתברות?
:class: tip

משתנה אקראי $X$ יהיה מאופיין על ידי פונקציית צפיפות הסתברות $p_{X}\left(x\right)$
אשר אומרת מה הסיכוי למדוד את המשתנה האקראי בטווח ערכים מסויים. כלומר:

$$\mathbb{P}\left(x_{1}<X<x_{2}\right)=\intop_{x_{1}}^{x_{2}}p_{X}\left(x\right)dx$$

נדרוש שתי תכונות:
1.  חיוביות - $p_{X}\left(x\right)\ge0$
2. נרמול -  $\intop_{\Omega}p_{X}\left(x\right)dx=1$

כאשר הכוונה ב$\Omega$ היא כל תחום הערכים של $X$. לרוב יהיה $\intop_{-\infty}^{\infty}p_{X}\left(x\right)dx=1$

```

```{admonition} דוגמא - התפלגות נורמלית
:class: dropdown

פונקציית צפיפות הסתברות שנעבוד איתה הרבה והיא מאוד מאוד מאוד נפוצה היא גאוסיין. (לפעמים נקראת נורמלית)

$$p_{X}\left(x\right)=\sqrt{\frac{1}{2\pi\sigma^{2}}}e^{-\frac{\left(x-\mu\right)^{2}}{2\sigma^{2}}}$$

כאשר $\mu$ היא הערך הממוצע ו$\sigma$ הסטיית תקן.
 מוזמנים לשחק עם הערכים כדי לראות אי ך הפונקצייה נראית. את ההתפלגות הנורמלית של ממוצע 0 וסטיית תקן 1 ציירתי בשחור
 
 <iframe src="https://www.geogebra.org/material/iframe/id/mb5n2gph" width="100%" style="border: 1px solid #ccc; aspect-ratio: 2 / 1" frameborder=0></iframe>
<a href="https://www.geogebra.org/material/iframe/id/mb5n2gph" target="_blank">לפתיחה בחלון נפרד</a>

מה מתפלג ככה? האמת שכמעט הכל (יש לזה סיבות טובות). לדוגמה גובה של אנשים:
![height-distribution.png](images/height-distribution.png)

מתוך הגרף הזה אתם יכולים לחשב לדוגמה מה הסיכוי שהגובה של גבר או אישה רנדומלים בעולם הם בין 170-175 .
זה פשוט לחשב אינטגרל (או לשאול מה השטח מתחת לגרף)

```

נרצה עכשיו להרחיב את ההגדרה של משתנה אקראי לתהליך אקראי או אות אקראי.
נצטרך עכשיו לתת הסתברות לכל אפשרות. כלומר תהיה לנו פונקצייה $\underset{\text{תפתושמ}-\text{תוגלפתה}}{\underbrace{p_{x\left(t\right)}\left(x_{1},x_{2},x_{3},...;t_{1},t_{2},t_{3},...\right)}}$
אשר מגדירה מה הסיכוי לאות מסויים:

$$\mathbb{P}\left(\left(x_{1}^{\prime}<x\left(t_{1}\right)<x_{1}^{\prime\prime}\right)\land\left(x_{2}^{\prime}<x\left(t_{2}\right)<x_{2}^{\prime\prime}\right)...\right)=\intop_{x_{1}^{\prime}}^{x_{1}^{\prime\prime}}\intop_{x_{2}^{\prime}}^{x_{2}^{\prime\prime}}...p_{x\left(t\right)}\left(x_{1},x_{2},...;t_{1},t_{2},...\right)...dx_{1}dx_{2}$$

זה מאוד לא שימושי, בעיקר שהאות שלנו הוא רציף ולא בדיד הרבה פעמים. נניח שתי הגדרות שמאוד
יקלו על ההגדרה והניתוח של האות האקראי. הן לא מתקיימות תמיד אבל כן לרוב.

### סטציונריות הגדרה מחמירה
נתחיל מהגדרה מחמירה של מה זה אות סטציונרי. נראה קצת דוגמאות וניקח הגדרה פחות מחמירה בהמשך.

נגדיר אות כסטציונרי (במובן הצר) אם פונקציית צפיפות ההסתברות שלו לא משתנה בזמן. כלומר:

$$\forall\tau\in\mathbb{R},\forall n\in\mathbb{N}:p_{x\left(t\right)}\left(x_{1},x_{2},...,x_{n};t_{1},t_{2},...t_{n}\right)=p_{x\left(t\right)}\left(x_{1},x_{2},...,x_{n};t_{1}+\tau,t_{2}+\tau,...t_{n}+\tau\right)$$

ובפרט עבור משתנה זמן בודד:

$$\boxed{\forall\tau\in\mathbb{R}:p_{x\left(t\right)}\left(x_{1};t_{1}\right)=p_{x\left(t\right)}\left(x_{1};t_{1}+\tau\right)}$$

מה זה אומר? במילים פשוטות זה אומר שאם תתחילו מדידה של האות בזמן כלשהו למשך זמן כלשהו הסטטיסטיקה
לא תהיה תלוייה בזמן התחלת המדידה.  שימו לב שזה נכון גם למדידה של מספר אחד ולכן **בפרט** הממוצע וסטיית
התקן לא משתנות בזמן. (זאת הולכת להיות ההגדרה שלנו בהמשך + פרט קטן).

דוגמאות לאותות שהם לא סטציונרים:
* התמפרטורה בחדר הזה - אם תמדדו בלילה או ביום תקבלו סטטיסטיקות שונות מאוד
* הרעש מחוץ לחלון הדירה שלי. במהלך היום יש תחב"צ ובפרט הרעש נמוך יותר בשבתות

נשים לב שזה שיש "שינוי" או אירועי קיצון לא אומר שהאות לא סטציונרי. זה רק
אומר שאירועים כאלו הם חלק מהסטטיסטיקה. מה שהופך את הדוגמאות קודם ללא
סטציונרים זה שיש "חוקיות" לשינוי של הסטטיסטיקה. לדוגמה בלילה וביום.
שימו לב שגם אם לא הייתי יודע שקיימים יום ולילה הייתי יכול
לחשב את ממוצע הטמפרטורה לאורך זמן ולראות מגמה מחזורית מובהקת.
והסיכוי לקבל מגמה כזו מובהקת במקרה הוא מאוד מאוד נמוך.

דוגמאות לאותות סטציונרים:
* רעש טרמי (בהינתן שהטמפרטורה קבועה) - התפלגות המהירויות של החלקיקים נשארת קבועה אם הטמפרטורה קבועה. ולכן גם הזרמים שהם יוצרים
* רעש שוט (בהנחה שהזרם נשאר קבוע)
* רעש מתפרץ - רעש שקופץ בין שני ערכים כאשר כמות המעברים מתפלגת פואסונית
* תנועה של חלקיק בדיפוזיה

חשוב להדגיש שתהליך אקראי הוא לא תמיד רעש אבל אותנו מעניינים רעשים. תהליך אקראי לדוגמה
שאינו רעש הוא ירי של ניורונים במוח שלנו.

### ארגודיות

התכונה השנייה שנניח על התהליכים האקראיים שלנו היא קצת יותר קשה לתפיסה.
בגדול היא אומרת ש:

> **ממוצע לאורך זמן הוא כמו ממוצע של הרבה מדידות חוזרות (ראליזציות)**

בנוסחה זה אומר ש:

$$\mathbb{E}\left[x\left(t\right)\right]=\left\langle x\left(t\right)\right\rangle $$

מה זה אומר בכלל. אתם רגילים ששני הביטויים האלו הם פשוט סימונים
שונים של הממוצע. מה שזה אומר הוא ש:

$$\underset{\mu_{x}}{\underbrace{\intop_{-\infty}^{\infty}x\cdot\mathbb{P}\left(x\right)dx}}=\underset{\left\langle x\left(t\right)\right\rangle }{\underbrace{\lim_{T\rightarrow\infty}\frac{1}{T}\intop_{0}^{T}x\left(t\right)dt}}$$

כלומר הממוצע של האות הוא גם הממוצע לאורך זמן.
(אנחנו נניח שבהגדרה של ארגודיות הממוצע לאורך זמן לא תלוי בזמן ההתחלה, 
כלומר האות סטציונרי)

איך בכלל שני הדברים האלו יכולים להיות שונים?
נשים לב שהם צריכים להיות שווים רק בגבול של זמן ארוך. כלומר
גם אם חישוב הממוצע לוקח המון זמן זה לא משנה.

דוגמה שממחישה למה הם יכולים להיות שונים היא הדוגמה הבאה:

נניח שיש לנו 2 קוביות על השולחן. אחת עם 6 פאות ואחת עם 12.
כלומר הממוצע של הראשונה הוא 3.5 ושל השנייה הוא 6.5.
התהליך האקראי הוא לקחת קוביה אקראית ולזרוק אותה אינסוף פעמים.
המספרים שיוצאים הם התהליך האקראי שלנו.
למה זה לא ארגודי?

צריך להבין מה הממוצע של התהליך. הממוצע מוגדר על הרבה חזרות של התהליך.
כאשר בחצי מהפעמים נבחר את הקוביה הראשונה ובחצי את הקובייה השנייה.
הממוצע יצא לנו $\frac{3.5+6.5}{2}=5$ אבל אם ניקח ניסוי אחד
לאורך הרבה זמן ונחשב את הממוצע יצא לנו או $3.5$ או $6.5$.

המסקנה היא:

> אם אנחנו התהליך יכול להיות תהליך שונה בכל פעם וזה נקבע בהתחלה, אז כנראה שהוא לא ארגודי

יכולות להיות הרבה דוגמאות לזה. אבל תנסו לדמיין שאנחנו מודדים בעזרת מכשיר מדידה רעש
אבל יכול להיות שיש פגם במכשיר. אז מה שבאמת צריך לעשות הוא לדגום בעזרת הרבה מכשירים.

או יש פאזה התחלתית בדוגם שיכולה להגביר או להחליש את הרעש והיא נקבעת על פי זמן
ההדלקה של המכשיר אז אנחנו יכולים להיות בבעיה.

יש עוד דוגמאות מעניינות ממש בפיזיקה אבל לא ניכנס לזה כאן.

למה ארגודיות חשובה לנו בכלל? היינו רוצים לומר שאם הממוצע של האות
לא תלוי בזמן (סטציונריות) אז ה מספיק.
הבעיה היא שלרוב במדידה אמיתית תהיה לנו רק ריאליזציה אחת של הרעש.
ולכן אם נחשוב שהממוצע של הרעש הוא הממוצע מהתכונה הסטציונרית
נוכל לטעות ולחשוב שזה הממוצע בכל קטע מספיק ארוך של זמן.

לרוב נניח שאות גם ארגודי בסטיית התקן שלו ובפונקציית האוטוקורלציה שלו (עוד על זה בהמשך).

### אפיון של האות האקראי

הבינתן שיש לנו דגימה של האות האקראי והוא סטציונרי וארגודי נוכל להתחיל לחשב
תכונות שלו:

* ממוצע - $\mu_{x}=\intop_{-\infty}^{\infty}x\cdot\mathbb{P}\left(x\right)dx=\lim_{T\rightarrow\infty}\frac{1}{T}\intop_{0}^{T}x\left(t\right)dt$
* סטיית תקן - **כמה אנחנו רחוקים מהממוצע בממוצע**

איך נחשב?

$$\sigma_{x}^{2}=\mathbb{E}\left[\left(x\left(t\right)-\mu_{x}\right)^{2}\right]=\mathbb{E}\left[x\left(t\right)^{2}-2\mu_{x}x\left(t\right)+\mu_{x}^{2}\right]=\mathbb{E}\left[x\left(t\right)^{2}\right]-2\mu_{x}\mathbb{E}\left[x\left(t\right)\right]+\mu_{x}^{2}$$
$$=\mathbb{E}\left[x\left(t\right)^{2}\right]-2\mu_{x}^{2}+\mu_{x}^{2}=\mathbb{E}\left[x\left(t\right)^{2}\right]-\mu_{x}^{2}=\left\langle x\left(t\right)^{2}\right\rangle -\mu_{x}^{2}=\lim_{T\rightarrow\infty}\frac{1}{T}\intop_{0}^{T}x\left(t\right)^{2}dt-\left(\lim_{T\rightarrow\infty}\frac{1}{T}\intop_{0}^{T}x\left(t\right)dt\right)^{2}$$

נשים לב שבמקרה שלנו האות $x\left(t\right)^{2}$ הוא לרוב בעל משמעות של הספק (אם האות שלנו הוא אמפליטודה של גל)
ולכן אפשר לחשוב על $\left\langle x\left(t\right)^{2}\right\rangle $ בתור ההספק הממוצע
נקבל מסקנה חמודה:

> באות בעל ממוצע 0 ($\mu_{x}=0$) סטיית התקן פרופורציונלית להספק הממוצע $\sigma_{x}^{2}\propto\left\langle P_{x}\right\rangle $

כלומר שסטיית התקן של רעש (שלרוב ההמוצע שלו הוא באמת 0) היא סופר חשובה לחישובי SNR

### אוטוקורלציה

יש לנו פיסה אחת שחסרה בפאזל. הבנו שאפשר לאפיין את האות האקראי עם פונקצייה $p_{x}$ אשר לא תלוייה בזמן
אבל מה הקשר בין הרעש בזמנים שונים? 
לדוגמה מה אם הייתי אומר לכם שאני מטיל קובייה אבל כל פעם אני לא מאפשר 
להטלה הקודמת לחזור על עצמה.
האם זה משנה את סטטיסטיקת ההטלות?
התשובה היא שברור שלו. עדיין אני אקבל התפלגות אחידה עבור
כל אחת מההטלות (עם הרבה חזרות על הניסוי)





